includes:
    - vendor/larastan/larastan/extension.neon

parameters:
    level: 8
    paths:
        - app/
        - config/
        - database/
        - routes/
        - tests/

    excludePaths:
        - bootstrap/
        - storage/
        - vendor/
        - node_modules/

    # Configuration de base compatible
    treatPhpDocTypesAsCertain: false
    reportUnmatchedIgnoredErrors: false

    # Paramètres de qualité de base pour niveau 8
    checkUninitializedProperties: true
    checkBenevolentUnionTypes: true
    checkExplicitMixedMissingReturn: true
    checkFunctionNameCase: true
    checkInternalClassCaseSensitivity: true
    checkTooWideReturnTypesInProtectedAndPublicMethods: true
    checkMissingCallableSignature: true

    # Support des features PHP modernes
    checkPhpDocMethodSignatures: true

    # Règles d'inférence de base
    polluteScopeWithLoopInitialAssignments: false
    polluteScopeWithAlwaysIterableForeach: false

    # Ignorer certaines erreurs spécifiques à Laravel
    ignoreErrors:
        - '#PHPDoc tag @var#'
        - '#Unsafe usage of new static#'
        - '#Cannot call method.*on.*\|null#'
        - '#Access to an undefined property App\\Models\\.*::\$.*#'
        - '#Call to an undefined method Illuminate\\Database\\Eloquent\\Builder.*#'
        - '#Method.*should return.*but returns Illuminate\\Database\\Eloquent\\Builder#'

    # Performance et parallélisation
    parallel:
        maximumNumberOfProcesses: 4
        minimumNumberOfJobsPerProcess: 20

    # Cache
    tmpDir: storage/phpstan

    # Type aliases utiles pour Laravel
    typeAliases:
        UserId: 'int<1, max>'
