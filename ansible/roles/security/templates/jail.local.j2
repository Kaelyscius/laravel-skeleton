# Configuration Fail2ban générée par Ansible
# Environnement: {{ environment }}

[DEFAULT]
# Durée de bannissement (en secondes)
bantime = {{ security.fail2ban.bantime | default(3600) }}

# Période d'observation (en secondes)
findtime = {{ security.fail2ban.findtime | default(600) }}

# Nombre d'essais maximum
maxretry = {{ security.fail2ban.maxretry | default(5) }}

# Actions
banaction = ufw
action = %(action_mwl)s

# Adresses IP à ignorer
ignoreip = 127.0.0.1/8 ::1

[sshd]
enabled = true
port = {{ security.ssh.port | default(22) }}
filter = sshd
logpath = /var/log/auth.log
maxretry = {{ security.ssh.max_auth_tries | default(3) }}

[apache-auth]
enabled = true
port = http,https
filter = apache-auth
logpath = /var/log/apache2/error.log
maxretry = 6

[apache-badbots]
enabled = true
port = http,https
filter = apache-badbots
logpath = /var/log/apache2/access.log
maxretry = 2

[apache-noscript]
enabled = true
port = http,https
filter = apache-noscript
logpath = /var/log/apache2/access.log
maxretry = 6

[apache-overflows]
enabled = true
port = http,https
filter = apache-overflows
logpath = /var/log/apache2/access.log
maxretry = 2

[apache-nohome]
enabled = true
port = http,https
filter = apache-nohome
logpath = /var/log/apache2/access.log
maxretry = 2

[apache-botsearch]
enabled = true
port = http,https
filter = apache-botsearch
logpath = /var/log/apache2/access.log
maxretry = 2